<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Certificado {{ numeroCertificado }}</title>
    <!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { font-family: Arial, sans-serif; margin: 0; padding: 20px; background-color: #fff; }
        .container { max-width: 950px; margin: 0 auto; background-color: white; padding: 20px; }
        .header-image { width: 100%; height: auto; margin-bottom: 20px; }
        .text-center { text-align: center; }
        .debug { background: #f0f8ff; padding: 10px; margin: 10px 0; border: 1px solid #ccc; }
        table { width: 100%; margin-bottom: 1rem; border-collapse: collapse; }
        th, td { padding: 0.75rem; border: 1px solid #dee2e6; }
        th { background-color: #f8f9fa; font-weight: bold; }
    </style> -->
</head>
<body>
    <div class="container">

        <!-- Botones -->
        <div class="text-end mb-3 no-print">
            <button class="btn btn-primary btn-sm" (click)="imprimirCertificado()">üñ®Ô∏è Imprimir</button>
            <button class="btn btn-secondary btn-sm ms-2" (click)="recargarPagina()">üîÑ Actualizar</button>
        </div>

        @if (isLoading) {
            <div class="text-center">
                <div class="spinner-border" role="status"></div>
                <p class="mt-2">Cargando certificado...</p>
            </div>
        }

        @if (mensaje) {
            <div class="alert alert-danger">{{ mensaje }}</div>
        }

        <!-- SOLUCI√ìN: Usar hasObjectProperties -->
        @if (hasObjectProperties(certificado)) {
            <!-- Encabezado -->
            <img src="/img/fon_cabezoteimg.jpg" alt="Header" class="header-image">
            <h5 class="text-center" style="font-size:15px;font-weight:bold;">
                CERTIFICADO DE INSPECCI√ìN SANITARIA<br>
                PRODUCTOS DE ORIGEN ANIMAL Y BIOL√ìGICOS
            </h5>
            
            <!-- Informaci√≥n principal -->
            <table class="table">
                <tr>
                    <th>PUERTO SALIDA:</th>
                    <td>{{ certificado.puerto_salida || 'N/A' }}</td>
                    <th>N√öMERO CIS:</th>
                    <td>{{ certificado.Numero_Cis || 'N/A' }}</td>
                </tr>
                <tr>
                    <th>PA√çS DESTINO:</th>
                    <td>{{ certificado.pais_destino || 'N/A' }}</td>
                    <th>PROCEDENCIA:</th>
                    <td>{{ certificado.procedencia || 'N/A' }}</td>
                </tr>
            </table>

            <!-- Productos -->
            @if (productos && productos.length > 0) {
                <h6 class="text-center"><strong>PRODUCTOS</strong></h6>
                <table class="table">
                    <thead>
                        <tr>
                            <th>Cantidad</th>
                            <th>Unidad</th>
                            <th>Producto</th>
                            <th>Presentaci√≥n</th>
                            <th>Raza</th>
                            <th>Valor FOB</th>
                        </tr>
                    </thead>
                    <tbody>
                        @for (producto of productos; track $index) {
                        <tr>
                            <td>{{ producto.cantidad || 'N/A' }}</td>
                            <td>{{ producto.unidad || 'N/A' }}</td>
                            <td>{{ producto.producto || 'N/A' }}</td>
                            <td>{{ producto.presentacion || 'N/A' }}</td>
                            <td>{{ producto.raza || 'N/A' }}</td>
                            <td>{{ formatNumber(producto.valor_fob) }}</td>
                        </tr>
                        }
                    </tbody>
                </table>
            } @else {
                <div class="alert alert-warning">No hay productos para mostrar</div>
            }

            <!-- Informaci√≥n adicional -->
            <table class="table">
                <tr>
                    <th>IMPORTADOR:</th>
                    <td colspan="3">{{ certificado.importador || 'N/A' }}</td>
                </tr>
                <tr>
                    <th>EXPORTADOR:</th>
                    <td colspan="3">{{ certificado.exportador || 'N/A' }}</td>
                </tr>
                <tr>
                    <th>OBSERVACIONES:</th>
                    <td colspan="3">{{ certificado.observaciones || 'N/A' }}</td>
                </tr>
            </table>

        } @else if (resultado && !isLoading) {
            <div class="alert alert-info">
                Certificado encontrado pero sin datos para mostrar
            </div>
        }
    </div>
</body>
</html>